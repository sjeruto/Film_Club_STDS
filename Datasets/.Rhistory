group_by(country, GENDER_EQUALITY) %>%
summarise(weighted_n = sum(weight))
# Write into CSV
write.csv(RELIGION_IMPORT, "RELIGION_IMPORT.csv")
write.csv(HOMOSEXUALITY, "HOMOSEXUALITY.csv")
write.csv(GENDER_EQUALITY, "GENDER_EQUALITY.csv")
# If you want to get the percentage proportions
RELIGION_IMPORT_P <- Pew_Data %>%
##by taking the sum of the weights
group_by(country, RELIGION_IMPORT) %>%
summarise(weighted_n = sum(weight)) %>%
##add the weighted_group_size to get the total weighted n and
##divide weighted_n by weighted_group_size to get the proportions
mutate(weighted_group_size = sum(weighted_n),
weighted_estimate = weighted_n / weighted_group_size
)
HOMOSEXUALITY_P <- Pew_Data %>%
##by taking the sum of the weights
group_by(country, HOMOSEXUALITY) %>%
summarise(weighted_n = sum(weight)) %>%
##add the weighted_group_size to get the total weighted n and
##divide weighted_n by weighted_group_size to get the proportions
mutate(weighted_group_size = sum(weighted_n),
weighted_estimate = weighted_n / weighted_group_size
)
GENDER_EQUALITY_P <- Pew_Data %>%
##by taking the sum of the weights
group_by(country, GENDER_EQUALITY) %>%
summarise(weighted_n = sum(weight)) %>%
##add the weighted_group_size to get the total weighted n and
##divide weighted_n by weighted_group_size to get the proportions
mutate(weighted_group_size = sum(weighted_n),
weighted_estimate = weighted_n / weighted_group_size
)
pacman::p_load(tidyverse, here, haven)
library("Amelia")
# https://medium.com/pew-research-center-decoded/using-tidyverse-tools-with-pew-research-center-survey-data-in-r-bdfe61de0909
#Pew Religious data survey. Download this dataset "Pew-Research-Center-Global-Attitudes-Spring-2019-Survey-Data" from PEW (https://www.pewresearch.org/global/dataset/september-2019-u-s-survey-data/)
Pew_Data <- read_sav(here("Data", "Pew Research Center Global Attitudes Spring 2019 Dataset WEB.sav"),
user_na = TRUE) %>%
as_factor()
#Q85. How important is religion in your life: very important, somew
Religion_d <- Pew_Data %>%
select(country, RELIGION_IMPORT)
# RELIGION_IMPORT <-
Pew_Data %>%
group_by(country, RELIGION_IMPORT) %>%
summarise(weighted_n = sum(weight))
# pivot_wider(names_from = RELIGION_IMPORT, values_from = n)
#Views on homosexuality
HOMOSEXUALITY <- Pew_Data %>%
group_by(country, HOMOSEXUALITY) %>%
summarise(weighted_n = sum(weight))
# View on Gender
GENDER_EQUALITY <- Pew_Data %>%
group_by(country, GENDER_EQUALITY) %>%
summarise(weighted_n = sum(weight))
# Write into CSV
write.csv(RELIGION_IMPORT, "RELIGION_IMPORT.csv")
write.csv(HOMOSEXUALITY, "HOMOSEXUALITY.csv")
write.csv(GENDER_EQUALITY, "GENDER_EQUALITY.csv")
# If you want to get the percentage proportions
RELIGION_IMPORT_P <- Pew_Data %>%
##by taking the sum of the weights
group_by(country, RELIGION_IMPORT) %>%
summarise(weighted_n = sum(weight)) %>%
##add the weighted_group_size to get the total weighted n and
##divide weighted_n by weighted_group_size to get the proportions
mutate(weighted_group_size = sum(weighted_n),
weighted_estimate = weighted_n / weighted_group_size
)
HOMOSEXUALITY_P <- Pew_Data %>%
##by taking the sum of the weights
group_by(country, HOMOSEXUALITY) %>%
summarise(weighted_n = sum(weight)) %>%
##add the weighted_group_size to get the total weighted n and
##divide weighted_n by weighted_group_size to get the proportions
mutate(weighted_group_size = sum(weighted_n),
weighted_estimate = weighted_n / weighted_group_size
)
GENDER_EQUALITY_P <- Pew_Data %>%
##by taking the sum of the weights
group_by(country, GENDER_EQUALITY) %>%
summarise(weighted_n = sum(weight)) %>%
##add the weighted_group_size to get the total weighted n and
##divide weighted_n by weighted_group_size to get the proportions
mutate(weighted_group_size = sum(weighted_n),
weighted_estimate = weighted_n / weighted_group_size
)
here()
here()
here?
here(C:\Users\Ray Tsui\Documents\1. STATISTICS FOR DATA SCIENCE\Assignment 2)
here(1. STATISTICS FOR DATA SCIENCE/Assignment 2)
here("1. STATISTICS FOR DATA SCIENCE\Assignment 2")
here("1. STATISTICS FOR DATA SCIENCE\")
here("1. STATISTICS FOR DATA SCIENCE\Assignment 2")
here("1. STATISTICS FOR DATA SCIENCE\Assignment 2\")
here()
library(tidyverse)
library(dummies)      # creating dummy variables
#import
combined <- read.csv('combined.csv')
tmdbdummy <- read.csv('tmdbdummy.csv')
tmdbdummy$X <- NULL
setwd("~/1. STATISTICS FOR DATA SCIENCE/Film_Club_STDS")
#import
combined <- read.csv('combined.csv')
tmdbdummy <- read.csv('tmdbdummy.csv')
tmdbdummy$X <- NULL
setwd("~/1. STATISTICS FOR DATA SCIENCE/Film_Club_STDS/Datasets")
#import
combined <- read.csv('combined.csv')
tmdbdummy <- read.csv('tmdbdummy.csv')
tmdbdummy$X <- NULL
#plot budget vs vote_avg.----
combined$avg <- ifelse(combined$budget > 13000000 & combined$vote_average < 5.4, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, vote_average, color = avg)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Rating")+
xlab("Budget") +
ylab("Rating")+
scale_x_continuous(labels = unit_format(unit = "M", scale = 1e-6))+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
library(plotly)       # ggplotly(), plot_ly()
library(scales)
#plot budget vs vote_avg.----
combined$avg <- ifelse(combined$budget > 13000000 & combined$vote_average < 5.4, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, vote_average, color = avg)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Rating")+
xlab("Budget") +
ylab("Rating")+
scale_x_continuous(labels = unit_format(unit = "M", scale = 1e-6))+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = unit_format(unit = "M", scale = 1e-6))+
scale_y_continuous(labels = unit_format(unit = "M", scale = 1e-6))+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = unit_format(unit = "M", scale = 1e-6))+
scale_y_continuous(labels = unit_format(unit = "M", scale = 1e-6, accuracy = 0))+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = unit_format(unit = "M", scale = 1e-6))+
scale_y_continuous(labels = unit_format(unit = "M", scale = 1e-6))+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels =label_dollar(rescale_large = rescale_short_scale()))+
scale_y_continuous(labels = unit_format(unit = "M", scale = 1e-6))+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels =label_dollar(rescale_large = rescale_short_scale()))+
scale_y_continuous(labels =label_dollar(rescale_large = rescale_short_scale()))+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
dollar <- label_dollar(rescale_large = rescale_short_scale())
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels =dollar)+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
warnings()
#plot budget vs vote_avg.
dollar <- label_dollar(scale = 0.1000)
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels =dollar)+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
dollar <- label_dollar(scale = 2)
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels =dollar)+
#plot budget vs vote_avg.
dollar <- label_dollar(scale = 2)
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels =dollar)+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
dollar <- label_dollar(scale = 0.1)
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels =dollar)+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
dollar <- label_dollar(scale = 0.5)
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels =dollar)+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
dollar <- label_dollar(scale = 0.01)
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels =dollar)+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
dollar <- label_dollar(scale = 0.0001)
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels =dollar)+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
dollar <- label_dollar(scale = 0.000001)
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels =dollar)+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
dollar <- label_dollar(prefix = "$", scale = 0.000001)
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels =dollar)+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.
dollar <- label_dollar(prefix = "$", scale = 0.000001, suffix = "M",)
combined$profit <- (combined$revenue - combined$budget)
combined$profitable <- ifelse(combined$profit < 0, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, profit, color = profitable)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Profit")+
xlab("Budget") +
ylab("Profit")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels =dollar)+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs profit
no_nas <- na.omit(combined)
no_nas <- no_nas %>%
filter(budget > 0 | revenue > 0)
ggplot(no_nas, aes(budget, (revenue-budget), colour = genres.name)) +
geom_point()+
ggtitle("budget vs profit")
#plot budget vs vote_avg.----
combined$avg <- ifelse(combined$budget > 13000000 & combined$vote_average < 5.4, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, vote_average, color = avg)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Rating")+
xlab("Budget") +
ylab("Rating")+
scale_x_continuous(labels = unit_format(unit = "M", scale = 1e-6))+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.----
dollar <- label_dollar(prefix = "$", scale = 0.000001, suffix = "M",)
combined$avg <- ifelse(combined$budget > 13000000 & combined$vote_average < 5.4, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, vote_average, color = avg)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Rating")+
xlab("Budget") +
ylab("Rating")+
scale_x_continuous(labels = dollar)+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.----
dollar <- label_dollar(prefix = "$", scale = 0.000001, suffix = "M",)
combined$avg <- ifelse(combined$budget > 13000000 & combined$vote_average < 5.4, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, vote_average, color = avg)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Rating")+
xlab("Budget") +
ylab("Rating")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels = label_number(accuracy = 0))
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.----
dollar <- label_dollar(prefix = "$", scale = 0.000001, suffix = "M",)
combined$avg <- ifelse(combined$budget > 13000000 & combined$vote_average < 5.4, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, vote_average, color = avg)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Rating")+
xlab("Budget") +
ylab("Rating")+
scale_x_continuous()+
scale_y_continuous(labels = label_number(accuracy = 0))
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.----
dollar <- label_dollar(prefix = "$", scale = 0.000001, suffix = "M",)
combined$avg <- ifelse(combined$budget > 13000000 & combined$vote_average < 5.4, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, vote_average, color = avg)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Rating")+
xlab("Budget") +
ylab("Rating")+
scale_x_continuous(accuracy = 0)+
scale_y_continuous(labels = label_number(accuracy = 0))+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.----
dollar <- label_dollar(prefix = "$", scale = 0.000001, suffix = "M",)
combined$avg <- ifelse(combined$budget > 13000000 & combined$vote_average < 5.4, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, vote_average, color = avg)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Rating")+
xlab("Budget") +
ylab("Rating")+
scale_x_continuous(accuracy = 1)+
scale_y_continuous(labels = label_number(accuracy = 0))+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
#plot budget vs vote_avg.----
dollar <- label_dollar(prefix = "$", scale = 0.000001, suffix = "M",)
combined$avg <- ifelse(combined$budget > 13000000 & combined$vote_average < 5.4, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, vote_average, color = avg)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Rating")+
xlab("Budget") +
ylab("Rating")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels = label_number(accuracy = 0))+
#plot budget vs vote_avg.----
dollar <- label_dollar(prefix = "$", scale = 0.000001, suffix = "M",)
combined$avg <- ifelse(combined$budget > 13000000 & combined$vote_average < 5.4, "0", "1")
combined <- combined %>%
filter(budget > 0 & revenue > 0)
ggplot(combined, aes(budget, vote_average, color = avg)) +
geom_point(alpha = 2/10) +
scale_color_manual(values=c('darkred','navy'))+
theme_minimal()+
ggtitle("Budget vs. Rating")+
xlab("Budget") +
ylab("Rating")+
scale_x_continuous(labels = dollar)+
scale_y_continuous(labels = label_number(accuracy = 0))+
theme(text=element_text(size=14,family="CM Roman"),  legend.position="none")
